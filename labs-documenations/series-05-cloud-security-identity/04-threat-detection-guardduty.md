<img src="https://cdn.prod.website-files.com/677c400686e724409a5a7409/6790ad949cf622dc8dcd9fe4_nextwork-logo-leather.svg" alt="NextWork" width="300" />

# Threat Detection with GuardDuty

**Project Link:** [View Project](http://learn.nextwork.org/projects/aws-security-guardduty)

**Author:** Roy Piring Jr  
**Email:** rpiringhawaii@gmail.com

---

![Image](http://learn.nextwork.org/refreshed_maroon_timid_jujube/uploads/aws-security-guardduty_v1w2x3y4)

---

## Introducing Today's Project!

### Tools and concepts

This project deploys an intentionally vulnerable web application and supporting AWS infrastructure to generate observable security telemetry. AWS CloudFormation provisions the environment. Amazon EC2 hosts the application. An Application Load Balancer fronts inbound traffic. Amazon S3 stores application-related artifacts. Amazon GuardDuty provides managed threat detection by analyzing AWS logs and runtime signals produced by the environment.

### Project reflection

The work focused on configuring GuardDuty, generating realistic attack patterns, and validating that findings were produced from actual activity. The primary constraint was detection latency, since GuardDuty findings are not instantaneous and depend on log ingestion and analysis.

The outcome was confirmation that GuardDuty generated findings corresponding to the simulated attacks performed against the environment.

---

## Project Setup

The environment is deployed from a CloudFormation template that launches the OWASP Juice Shop application in an insecure configuration. The stack consists of an EC2 instance running the application, an Application Load Balancer to expose it over HTTP, and an S3 bucket used by the deployment. The infrastructure exists solely to produce security-relevant signals and does not represent a hardened or production-ready design.

The environment is used to exercise GuardDuty by deliberately interacting with known vulnerable application paths. The intent is to generate suspicious behavior that GuardDuty can observe through VPC Flow Logs, CloudTrail events, and related data sources.

GuardDuty is used as a managed detection layer rather than an inline protection system. In this context, it analyzes telemetry generated by the deployed resources and surfaces findings related to anomalous or known malicious patterns that occur within the AWS account.

![Image](http://learn.nextwork.org/refreshed_maroon_timid_jujube/uploads/aws-security-guardduty_n1o2p3q4)

---

## SQL Injection

SQL injection is an application-layer attack where crafted input is passed to backend data stores without proper sanitization. The risk is unauthorized data access or manipulation caused by the application executing unintended queries.

The attack activity consisted of submitting crafted input through exposed application fields to trigger database queries outside normal usage patterns. The purpose was to simulate malicious behavior that would generate abnormal request and query patterns visible to GuardDutyâ€™s detection models.

![Image](http://learn.nextwork.org/refreshed_maroon_timid_jujube/uploads/aws-security-guardduty_h1i2j3k4)

---

## Command Injection

Command injection occurs when application input is passed to the underlying operating system without validation. This can result in arbitrary command execution within the runtime environment.

The activity involved submitting input designed to invoke system-level commands through the application interface. The intent was not system compromise, but to generate suspicious execution behavior that could be correlated by GuardDuty with known attack techniques.

![Image](http://learn.nextwork.org/refreshed_maroon_timid_jujube/uploads/aws-security-guardduty_t3u4v5w6)

---

## Attack Verification

Attack success was verified at the application level by confirming that injected input resulted in unauthorized access to sensitive application data. This validation step ensured that the simulated attack paths were exercised and that corresponding telemetry would exist for GuardDuty to analyze.

![Image](http://learn.nextwork.org/refreshed_maroon_timid_jujube/uploads/aws-security-guardduty_x7y8z9a0)

---

## Using CloudShell for Advanced Attacks

AWS CloudShell was used as a controlled execution environment for interacting with the deployed application and related resources. CloudShell provides authenticated access to AWS APIs and a managed shell without introducing additional infrastructure into the environment.

Within CloudShell, standard command-line utilities were used to retrieve and inspect external files and data structures. This activity simulated suspicious download and inspection behavior originating from within the AWS account rather than from an external host.

A custom GuardDuty detector configuration was created to ensure that relevant finding types were enabled. This was required because default configurations may not surface all categories of interest for this specific attack simulation.

![Image](http://learn.nextwork.org/refreshed_maroon_timid_jujube/uploads/aws-security-guardduty_j9k0l1m2)

---

## GuardDuty's Findings

GuardDuty produced findings after analyzing the generated activity over a short period. Findings represent assessed security events derived from log data and behavioral analysis rather than direct blocking actions.

One finding indicated a potential SQL injection attempt. This finding reflects GuardDuty identifying request patterns that deviate from baseline behavior and match known indicators of injection activity.

The finding details included the affected resource, the nature of the suspicious activity, and contextual metadata. This information demonstrates how GuardDuty surfaces actionable signals for downstream investigation rather than performing remediation.

![Image](http://learn.nextwork.org/refreshed_maroon_timid_jujube/uploads/aws-security-guardduty_v1w2x3y4)

---

## Extra: Malware Protection

GuardDuty malware protection was enabled to extend detection beyond network and API activity. This feature analyzes file system behavior and known malware indicators associated with supported compute resources.

A standard, non-destructive test artifact commonly used for malware detection validation was introduced into the environment. The artifact is designed to trigger detection logic without causing harm.

GuardDuty generated a malware-related finding after the artifact was introduced. This confirmed that the malware protection capability was active and capable of identifying known malicious signatures within the scope of the test environment.

![Image](http://learn.nextwork.org/refreshed_maroon_timid_jujube/uploads/aws-security-guardduty_sm42x3y4)

---
